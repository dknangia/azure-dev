using System.Data.Common;
using System.Linq;
using System.Net.Http.Headers;
using System.Text;
using Azure;
using Azure.Core.Serialization;
using Azure.Search.Documents;
using Azure.Search.Documents.Models;
using Microsoft.Spatial;
using Newtonsoft.Json;
using static Microsoft.Spatial.GeographyPoint;

namespace ReadJson;

public class AzureManager
{
    private readonly IAppConfiguration _configuration;

    private GeographyPoint?[] _Randomlocations =
    {
        Create(43.708279, -79.40007),
        Create(43.01297, -81.15107),
        Create(45.3647, -75.729973)
    };

    private string[] virtualDealers =
    {
        "10061570",
        "10061572",
        "10061573",
        "10137614",
        "17036017",
        "17036021",
        "17036024",
        "17036028",
        "17036031",
        "17036033",
        "17036036",
        "17036038",
        "17036043",
        "17036046",
        "17036049",
        "17036053",
        "17036056",
        "17036059",
        "17036074",
        "17036081",
        "17036091",
        "17036153",
        "17036186",
        "17036227",
        "17036228",
        "17036229",
        "17036232",
        "17036234",
        "17036236",
        "17036237",
        "17036252",
        "17036311",
        "17036315",
        "17036349",
        "17036355",
        "17036370",
        "17036371",
        "17036373",
        "17036374",
        "17036375",
        "17036493",
        "17036494",
        "17036495",
        "17036537",
        "17036627",
        "17036629",
        "17036630",
        "17036647",
        "17036650",
        "17036651",
        "17036745",
        "17080798",
        "17130974",
        "17131008",
        "17131010",
        "17131011",
        "17131013",
        "17131016",
        "17131021",
        "17131026",
        "17131028",
        "17131029",
        "17131031",
        "17131035",
        "17131036",
        "17131038",
        "17131045",
        "17131046",
        "17131068",
        "17131069",
        "17131071",
        "17131072",
        "17131073",
        "17131074",
        "17131075",
        "17131077",
        "17131084",
        "17131086",
        "17131088",
        "17131089",
        "17131093",
        "17131095",
        "17131096",
        "17131099",
        "17131100",
        "17131101",
        "17131102",
        "17131106",
        "17131107",
        "17131108",
        "17131109",
        "17131113",
        "17131114",
        "17131115",
        "17131163",
        "17131164",
        "17131167",
        "17131168",
        "17131170",
        "17131171",
        "17131172",
        "17131173",
        "17131174",
        "17131175",
        "17131176",
        "17131177",
        "17131178",
        "17131179",
        "17131180",
        "17131182",
        "17131184",
        "17131185",
        "17131186",
        "17131187",
        "17131188",
        "17131189",
        "17131192",
        "17131197",
        "17131198",
        "17131199",
        "17131202",
        "17131203",
        "17131204",
        "17131205",
        "17131207",
        "17131209",
        "17131210",
        "17131211",
        "17131217",
        "17131218",
        "17131219",
        "17131220",
        "17131229",
        "17131230",
        "17131231",
        "17131232",
        "17131233",
        "17131234",
        "17131236",
        "17131237",
        "17131238",
        "17131239",
        "17131240",
        "17131241",
        "17131242",
        "17132667",
        "17132668",
        "17132670",
        "17132671",
        "17132672",
        "17132674",
        "17132675",
        "17132676",
        "17132677",
        "17132678",
        "17132679",
        "17132680",
        "17132681",
        "17132682",
        "17132684",
        "17132685",
        "17132686",
        "17132687",
        "17132688",
        "17132689",
        "17132690",
        "17132692",
        "17132693",
        "17132694",
        "17132695",
        "17132696",
        "17132697",
        "17132698",
        "17132699",
        "17132700",
        "17132701",
        "17132702",
        "17132703",
        "17132704",
        "17132705",
        "17132706",
        "17132707",
        "17132708",
        "17740162",
        "17740163",
        "17740164",
        "17740165",
        "17740166",
        "17740167",
        "17740168",
        "17740169",
        "17740170",
        "17740182",
        "17740183",
        "17740184",
        "17740185",
        "17740186",
        "17740187",
        "17740188",
        "17740189",
        "17740190",
        "17740191",
        "17740192",
        "17740193",
        "17740194",
        "17740195",
        "17740196",
        "17740197",
        "17740198",
        "17740199",
        "17740200",
        "17740201",
        "17740202",
        "17740203",
        "17740204",
        "17740205",
        "17740206",
        "17740207",
        "17740208",
        "17740209",
        "17740210",
        "17740211",
        "17740212",
        "17740213",
        "17740214",
        "17740215",
        "17740216",
        "17740217",
        "17740218",
        "17740219",
        "17740463",
        "17740464",
        "17740465",
        "17740466",
        "17740467",
        "17740468",
        "17740469",
        "17740470",
        "17740471",
        "17740472",
        "17740473",
        "17763330",
        "17763331",
        "17763332",
        "17763333",
        "17763336",
        "17763337",
        "17763338",
        "17763339",
        "17763344",
        "17763345",
        "17763346",
        "17763347",
        "17763348",
        "17763349",
        "17763350",
        "17763351",
        "17763352",
        "17763353",
        "17766090",
        "17773754",
        "17787369",
        "17797494",
        "17797495",
        "17797517",
        "17797518",
        "17797801",
        "17803819",
        "17803852",
        "17804310",
        "17804313",
        "17804354",
        "17807910",
        "17833969",
        "17847447",
        "17876171",
        "17877282",
        "17904715",
        "17919555",
        "17930319",
        "17968040",
        "17973592",
        "17973597",
        "17980998",
        "18008831",
        "18017335",
        "18027934",
        "18034322",
        "18035897",
        "18044206",
        "18046562",
        "18046563",
        "18046564",
        "18046565",
        "18046566",
        "18046567",
        "18046568",
        "18046569",
        "18046570",
        "18046571",
        "18046572",
        "18046573",
        "18046574",
        "18046575",
        "18046576",
        "18046577",
        "18046578",
        "18046579",
        "18046580",
        "18046581",
        "18046582",
        "18046583",
        "18046584",
        "18046585",
        "18046586",
        "18046587",
        "18046589",
        "18046590",
        "18046591",
        "18046592",
        "18046593",
        "18046594",
        "18046595",
        "18046596",
        "18046597",
        "18046598",
        "18046599",
        "18046600",
        "18046601",
        "18046602",
        "18046767",
        "18046768",
        "18046769",
        "18046770",
        "18046771",
        "18046772",
        "18046773",
        "18046774",
        "18046775",
        "18046776",
        "18046777",
        "18046778",
        "18046779",
        "18046780",
        "18046781",
        "18046782",
        "18046783",
        "18046784",
        "18046785",
        "18046786",
        "18046787",
        "18046788",
        "18046789",
        "18046790",
        "18046791",
        "18046792",
        "18046793",
        "18046794",
        "18046795",
        "18046796",
        "18046797",
        "18046798",
        "18046799",
        "18046800",
        "18068287",
        "18068288",
        "18076570",
        "18097895",
        "18097932",
        "1812019",
        "18140704",
        "18144570",
        "18149301",
        "18149302",
        "18149303",
        "18149304",
        "18149305",
        "18149306",
        "18149307",
        "18149308",
        "18149309",
        "18149310",
        "18149311",
        "18149312",
        "18149313",
        "18149314",
        "18149315",
        "18149316",
        "18149317",
        "18149318",
        "18149319",
        "18149320",
        "18149321",
        "18149322",
        "18163288",
        "18164329",
        "18172856",
        "18172996",
        "18197936",
        "18198000",
        "18198001",
        "18199702",
        "18207239",
        "18210170",
        "18231157",
        "18231709",
        "18239428",
        "18239429",
        "18239430",
        "18247250",
        "18247252",
        "18265824",
        "18265891",
        "18265892",
        "18265894",
        "18266169",
        "18268276",
        "18298317",
        "18298506",
        "18298877",
        "18306433",
        "18313144",
        "18323583",
        "18329817",
        "18334119",
        "18335971",
        "18351593",
        "18351702",
        "18358447",
        "18358795",
        "18358831",
        "18358943",
        "18361648",
        "18365348",
        "18374518",
        "18384668",
        "18386837",
        "18403089",
        "18404838",
        "18405266",
        "18405989",
        "18413817",
        "18413909",
        "18413910",
        "18423152",
        "18423354",
        "18423360",
        "18423488",
        "18423489",
        "18423718",
        "18423951",
        "18423952",
        "18424329",
        "18424360",
        "18424362",
        "18424363",
        "18424509",
        "18425059",
        "18425089",
        "18425091",
        "18425269",
        "18435094",
        "18442521",
        "18445311",
        "18462099",
        "18466396",
        "18469279",
        "18518526",
        "18534900",
        "18537220",
        "18558263",
        "18586835",
        "18606483",
        "18606484",
        "18633421",
        "18633422",
        "18650545",
        "18653779",
        "18654409",
        "18654569",
        "18654995",
        "18659937",
        "18663106",
        "18681608",
        "18681610",
        "18681612",
        "18681613",
        "18681617",
        "18681621",
        "18681622",
        "18681623",
        "18681624",
        "18681716",
        "18681718",
        "18681722",
        "18681723",
        "18681724",
        "18681728",
        "18681730",
        "18681731",
        "18681732",
        "18681733",
        "18681744",
        "18681745",
        "18681747",
        "18681756",
        "18681758",
        "18681761",
        "18683205",
        "18683206",
        "18693341",
        "18697829",
        "18725806",
        "18727575",
        "18747225",
        "18796625",
        "18796634",
        "18806373",
        "18819006",
        "18819277",
        "18820673",
        "18823883",
        "18834449",
        "18840960",
        "18842773",
        "18842774",
        "18842775",
        "18842776",
        "18842779",
        "18842780",
        "18842781",
        "18842782",
        "18842801",
        "18842802",
        "18842803",
        "18842805",
        "18842806",
        "18842807",
        "18842810",
        "18842812",
        "18842813",
        "18842816",
        "18842834",
        "18842836",
        "18842838",
        "18842840",
        "18842848",
        "18842857",
        "18842892",
        "18842896",
        "18842898",
        "18842899",
        "18842902",
        "18842905",
        "18842914",
        "18842968",
        "18842970",
        "18842973",
        "18842974",
        "18842975",
        "18842976",
        "18842977",
        "18842978",
        "18842979",
        "18842980",
        "18842981",
        "18842982",
        "18842984",
        "18842985",
        "18842986",
        "18842987",
        "18842988",
        "18842989",
        "18842990",
        "18842991",
        "18842992",
        "18842995",
        "18842996",
        "18842997",
        "18842999",
        "18843000",
        "18843001",
        "18843003",
        "18843004",
        "18843005",
        "18843006",
        "18843007",
        "18843008",
        "18843009",
        "18843010",
        "18843011",
        "18843012",
        "18843013",
        "18843015",
        "18843016",
        "18843022",
        "18843027",
        "18843028",
        "18843030",
        "18843031",
        "18843032",
        "18843033",
        "18843034",
        "18843035",
        "18843036",
        "18843038",
        "18843039",
        "18843042",
        "18843046",
        "18843047",
        "18843050",
        "18843052",
        "18843053",
        "18843054",
        "18843056",
        "18843057",
        "18843058",
        "18843059",
        "18843061",
        "18843063",
        "18843064",
        "18843065",
        "18843066",
        "18843067",
        "18843068",
        "18843069",
        "18843070",
        "18843071",
        "18843072",
        "18843073",
        "18843074",
        "18843078",
        "18843080",
        "18843082",
        "18843083",
        "18843092",
        "18843097",
        "18843100",
        "18843171",
        "18843172",
        "18843191",
        "18843204",
        "18843216",
        "18843219",
        "18843225",
        "18843226",
        "18843229",
        "18843230",
        "18843231",
        "18843232",
        "18843258",
        "18843282",
        "18843283",
        "18843291",
        "18843301",
        "18843302",
        "18843308",
        "18843309",
        "18843310",
        "18843312",
        "18843317",
        "18843318",
        "18843346",
        "18843356",
        "18843357",
        "18843365",
        "18843391",
        "18843392",
        "18843396",
        "18843397",
        "18843398",
        "18843399",
        "18843400",
        "18843401",
        "18843402",
        "18843403",
        "18843404",
        "18843405",
        "18843406",
        "18843407",
        "18843408",
        "18843409",
        "18843410",
        "18843411",
        "18843473",
        "18843476",
        "18843477",
        "18843479",
        "18843480",
        "18843484",
        "18843485",
        "18843488",
        "18843489",
        "18843490",
        "18843491",
        "18843492",
        "18843494",
        "18843496",
        "18843497",
        "18843504",
        "18843505",
        "18843506",
        "18843507",
        "18843508",
        "18843510",
        "18843511",
        "18843513",
        "18843514",
        "18843515",
        "18843516",
        "18843517",
        "18843518",
        "18843519",
        "18843523",
        "18843525",
        "18843526",
        "18843527",
        "18843528",
        "18843529",
        "18843530",
        "18843531",
        "18843532",
        "18843534",
        "18843535",
        "18843537",
        "18843538",
        "18843539",
        "18843540",
        "18843542",
        "18843545",
        "18843546",
        "18843547",
        "18843548",
        "18843550",
        "18843551",
        "18843553",
        "18843554",
        "18843555",
        "18843557",
        "18843558",
        "18843560",
        "18843561",
        "18843562",
        "18843563",
        "18843564",
        "18843565",
        "18843566",
        "18843567",
        "18843568",
        "18843569",
        "18843570",
        "18843571",
        "18843572",
        "18843573",
        "18843574",
        "18843575",
        "18843578",
        "18843586",
        "18843587",
        "18843589",
        "18843590",
        "18843591",
        "18843592",
        "18843593",
        "18843615",
        "18843616",
        "18843617",
        "18843618",
        "18843620",
        "18843621",
        "18843622",
        "18843623",
        "18843624",
        "18843636",
        "18843637",
        "18843638",
        "18843639",
        "18843640",
        "18843641",
        "18843642",
        "18843643",
        "18843644",
        "18843645",
        "18843646",
        "18843647",
        "18843650",
        "18843652",
        "18843653",
        "18843654",
        "18843655",
        "18843656",
        "18843657",
        "18843669",
        "18843670",
        "18843673",
        "18843674",
        "18843676",
        "18843677",
        "18843679",
        "18843680",
        "18843684",
        "18843707",
        "18843708",
        "18843709",
        "18843710",
        "18843718",
        "18843728",
        "18843730",
        "18843731",
        "18843732",
        "18843733",
        "18843734",
        "18843735",
        "18843736",
        "18843737",
        "18843739",
        "18843740",
        "18843758",
        "18843760",
        "18843761",
        "18843762",
        "18843764",
        "18843765",
        "18843766",
        "18843767",
        "18843768",
        "18843769",
        "18843770",
        "18843771",
        "18845159",
        "18852574",
        "18852983",
        "18853001",
        "18853028",
        "18860745",
        "18868185",
        "18868398",
        "18869500",
        "18869510",
        "18869511",
        "18869816",
        "18875798",
        "18877024",
        "18878267",
        "18888405",
        "18890430",
        "18898567",
        "18899443",
        "18899525",
        "18899689",
        "18906808",
        "18907041",
        "18934711",
        "18951179",
        "18957943",
        "18957961",
        "18965792",
        "18980096",
        "18988513",
        "18991893",
        "18992548",
        "19005601",
        "19005770",
        "19010945",
        "19011899",
        "19038700",
        "19044755",
        "19046514",
        "19047070",
        "19055939",
        "19058232",
        "19064665",
        "19065225",
        "19065227",
        "19065228",
        "19072332",
        "19082257",
        "19089252",
        "19092985",
        "19093119",
        "19104821",
        "19113316",
        "19119948",
        "19126544",
        "19127060",
        "19135749",
        "19137156",
        "19137520",
        "19155933",
        "19163421",
        "19164241",
        "19170827",
        "19177050",
        "19185002",
        "19186244",
        "19192795",
        "19193704",
        "19203277",
        "19203547",
        "19204849",
        "19204919",
        "19228117",
        "19228673",
        "19238378",
        "19238847",
        "19238848",
        "19246341",
        "19246403",
        "19246404",
        "19246406",
        "19246877",
        "19254417",
        "19254809",
        "19276388",
        "19283933",
        "19284319",
        "19284320",
        "19284321",
        "19284322",
        "19284323",
        "19284324",
        "19284326",
        "19284327",
        "19284328",
        "19284330",
        "19284331",
        "19284332",
        "19284334",
        "19284335",
        "19284337",
        "19284338",
        "19284339",
        "19284342",
        "19284343",
        "19284344",
        "19284346",
        "19284348",
        "19284350",
        "19303408",
        "19309334",
        "19310512",
        "19311348",
        "19318357",
        "19324045",
        "19324590",
        "19325019",
        "19330513",
        "19345679",
        "19348044",
        "19356825",
        "19356968",
        "19356997",
        "19356999",
        "19357001",
        "19357006",
        "19357008",
        "19357010",
        "19357040",
        "19357042",
        "19357044",
        "19357046",
        "19358270",
        "19363972",
        "19364379",
        "19364443",
        "19364444",
        "19364482",
        "19364528",
        "19364761",
        "19368802",
        "19370536",
        "19370718",
        "19371281",
        "19388817",
        "19396839",
        "19397537",
        "19398159",
        "19398526",
        "19398532",
        "19398540",
        "19416018",
        "19425569",
        "19426536",
        "19426546",
        "19434919",
        "19437709",
        "19449539",
        "19461258",
        "19462098",
        "19467435",
        "19467436",
        "19467477",
        "19470495",
        "19481365",
        "19481704",
        "19481705",
        "19481746",
        "19481771",
        "19487403",
        "19493973",
        "19497182",
        "19503778",
        "19503953",
        "19503957",
        "19503958",
        "19503961",
        "19504788",
        "19504794",
        "19504826",
        "19504858",
        "19504862",
        "19504876",
        "19504879",
        "19504880",
        "19504881",
        "19504885",
        "19504905",
        "19504930",
        "19504941",
        "19504953",
        "19507410",
        "19519844",
        "19520381",
        "19529749",
        "19531487",
        "19543235",
        "19545325",
        "1954879",
        "19558455",
        "19565645",
        "19565718",
        "19566226",
        "19566303",
        "19574549",
        "19575568",
        "19576313",
        "19577154",
        "19586618",
        "19587218",
        "19595008",
        "19600870",
        "19613381",
        "19624363",
        "19624467",
        "19638216",
        "19639659",
        "19639858",
        "19660845",
        "19661473",
        "19662210",
        "19684957",
        "19686315",
        "19687051",
        "19689275",
        "19698209",
        "19705639",
        "19711644",
        "19711674",
        "19711710",
        "19715093",
        "19715095",
        "19715522",
        "19736676",
        "19737705",
        "19739095",
        "19752434",
        "19752578",
        "19762283",
        "19765691",
        "19765802",
        "19765839",
        "19798010",
        "19799025",
        "19799109",
        "19800193",
        "19810374",
        "19811490",
        "19811551",
        "19811831",
        "19812342",
        "19812464",
        "19813379",
        "19824176",
        "19824384",
        "19824435",
        "19824565",
        "19827986",
        "19836328",
        "19839860",
        "19842157",
        "19850929",
        "19851401",
        "19851781",
        "19852814",
        "19875780",
        "19889750",
        "19889751",
        "19889752",
        "19889753",
        "19889754",
        "19889755",
        "19889756",
        "19889757",
        "19889759",
        "19889760",
        "19889761",
        "19889762",
        "19889763",
        "19889764",
        "19889765",
        "19889766",
        "19889769",
        "19889770",
        "19889771",
        "19889772",
        "19889773",
        "19889774",
        "19889775",
        "19889777",
        "19889780",
        "19889782",
        "19889783",
        "19889785",
        "19889786",
        "19889787",
        "19889788",
        "19889789",
        "19889790",
        "19889791",
        "19889792",
        "19889793",
        "19889794",
        "19889795",
        "19889796",
        "19889797",
        "19889798",
        "19889799",
        "19889800",
        "19889801",
        "19889802",
        "19889804",
        "19889805",
        "19889807",
        "19889808",
        "19889809",
        "19889810",
        "19889811",
        "19889812",
        "19889813",
        "19889814",
        "19889815",
        "19889816",
        "19889817",
        "19889818",
        "19889819",
        "19889820",
        "19889821",
        "19889823",
        "19889824",
        "19889825",
        "19889826",
        "19889827",
        "19889828",
        "19889830",
        "19889835",
        "19889836",
        "19889837",
        "19889839",
        "19889840",
        "19889841",
        "19889842",
        "19889843",
        "19889844",
        "19889845",
        "19889846",
        "19889847",
        "19889848",
        "19889849",
        "19889850",
        "19889851",
        "19889852",
        "19889853",
        "19889854",
        "19889855",
        "19889856",
        "19889857",
        "19889858",
        "19889859",
        "19889860",
        "19889861",
        "19889862",
        "19889863",
        "19889864",
        "19889865",
        "19889866",
        "19889867",
        "19889868",
        "19889869",
        "19889870",
        "19889871",
        "19889872",
        "19889873",
        "19889874",
        "19889875",
        "19889876",
        "19889877",
        "19889878",
        "19889879",
        "19889880",
        "19889881",
        "19889882",
        "19889883",
        "19889884",
        "19889885",
        "19889886",
        "19889887",
        "19889888",
        "19889889",
        "19889890",
        "19889891",
        "19889892",
        "19889893",
        "19889894",
        "19889895",
        "19889896",
        "19889897",
        "19889898",
        "19889899",
        "19889900",
        "19889901",
        "19889902",
        "19889903",
        "19889905",
        "19889906",
        "19889907",
        "19889908",
        "19890237",
        "19902196",
        "19903135",
        "19903190",
        "19903254",
        "19903444",
        "19903481",
        "19903740",
        "19934684",
        "19935514",
        "19942752",
        "19958194",
        "19971634",
        "19972016",
        "19972044",
        "19973336",
        "19973554",
        "19973868",
        "19973914",
        "19974528",
        "19986564",
        "19987317",
        "19998013",
        "20005211",
        "20013924",
        "20013988",
        "20026090",
        "20026141",
        "20049042",
        "20056370",
        "20068095",
        "20068133",
        "20068135",
        "20071554",
        "20072219",
        "20073461",
        "20083183",
        "20083617",
        "20090700",
        "20098857",
        "20100038",
        "20100039",
        "20100041",
        "20100042",
        "20100043",
        "20100044",
        "20100045",
        "20100046",
        "20100047",
        "20100048",
        "20100049",
        "20100050",
        "20100051",
        "20100052",
        "20100053",
        "20100054",
        "20100055",
        "20100056",
        "20100057",
        "20100058",
        "20100059",
        "20100060",
        "20100094",
        "20100095",
        "20100096",
        "20100097",
        "20100098",
        "20100099",
        "20100100",
        "20100101",
        "20100102",
        "20100103",
        "20100104",
        "20100105",
        "20100106",
        "20100107",
        "20100108",
        "20100109",
        "20100110",
        "20100111",
        "20100112",
        "20100113",
        "20100114",
        "20100115",
        "20100116",
        "20100118",
        "20100119",
        "20100120",
        "20100121",
        "20100122",
        "20100123",
        "20100124",
        "20100125",
        "20100126",
        "20100127",
        "20100128",
        "20100129",
        "20100130",
        "20100131",
        "20100132",
        "20100133",
        "20100134",
        "20100135",
        "20100136",
        "20100137",
        "20100169",
        "20100170",
        "20100171",
        "20100172",
        "20100173",
        "20100174",
        "20100175",
        "20100176",
        "20100177",
        "20100178",
        "20100179",
        "20100180",
        "20100181",
        "20100182",
        "20100183",
        "20100184",
        "20100185",
        "20100186",
        "20100187",
        "20100188",
        "20100189",
        "20100190",
        "20100191",
        "20100192",
        "20100193",
        "20100194",
        "20100195",
        "20100196",
        "20100197",
        "20100198",
        "20100199",
        "20100200",
        "20100201",
        "20100202",
        "20100203",
        "20100204",
        "20100205",
        "20100206",
        "20100207",
        "20100208",
        "20100209",
        "20100210",
        "20100211",
        "20100212",
        "20100213",
        "20100214",
        "20100215",
        "20100216",
        "20100217",
        "20100218",
        "20100219",
        "20100220",
        "20100221",
        "20100222",
        "20100223",
        "20100224",
        "20100225",
        "20100226",
        "20100227",
        "20100228",
        "20100229",
        "20100230",
        "20100231",
        "20100232",
        "20100233",
        "20100234",
        "20100235",
        "20100236",
        "20100237",
        "20100238",
        "20100239",
        "20100240",
        "20100241",
        "20100242",
        "20100243",
        "20100244",
        "20100245",
        "20100246",
        "20100247",
        "20100248",
        "20100249",
        "20100250",
        "20100251",
        "20100252",
        "20100253",
        "20100254",
        "20100255",
        "20100256",
        "20100257",
        "20100258",
        "20100259",
        "20101667",
        "20111782",
        "20111791",
        "20111792",
        "20111793",
        "20111794",
        "20111795",
        "20111796",
        "20111797",
        "20111798",
        "20111799",
        "20111800",
        "20111801",
        "20111802",
        "20111807",
        "20111808",
        "20111809",
        "20111810",
        "20111811",
        "20111812",
        "20111813",
        "20111814",
        "20111815",
        "20111816",
        "20111817",
        "20111818",
        "20111819",
        "20111820",
        "20111829",
        "20111830",
        "20111834",
        "20111835",
        "20111836",
        "20111837",
        "20111838",
        "20111839",
        "20111840",
        "20111841",
        "20111843",
        "20111844",
        "20111845",
        "20111846",
        "20111847",
        "20111848",
        "20111849",
        "20111850",
        "20111851",
        "20111852",
        "20111853",
        "20111854",
        "20111855",
        "20111856",
        "20111857",
        "20111858",
        "20111859",
        "20111863",
        "20111864",
        "20111865",
        "20111866",
        "20111867",
        "20111868",
        "20111869",
        "20111870",
        "20111872",
        "20111873",
        "20111874",
        "15424243",
        "15485874",
        "1551247",
        "15533875",
        "15535009",
        "15535010",
        "15544023",
        "15544024",
        "15686871"
    };

    public AzureManager(IAppConfiguration configuration)
    {
        _configuration = configuration;
    }

    private SearchClient GetServiceClient(SearchClientOptions clientOptions)
    {
        return new SearchClient(
            new Uri(_configuration.GetValue("SearchService:EndPoint") ?? string.Empty),
            _configuration.GetValue("SearchService:IndexName"),
            new AzureKeyCredential(_configuration.GetValue("SearchService:ApiKey") ?? string.Empty), clientOptions);
    }

    public async Task GetResults()
    {
        var options = new SearchOptions()
        {
            //Filter = "ForeignId eq '25649250'",
            IncludeTotalCount = true,
            OrderBy = { "ForeignId" },
            Skip = 12000,
            Size = 6000,
            Select = { "Id", "ForeignId", "Location", "SearchLocations" }
        };

        var jsonSerializerSettings = new JsonSerializerSettings
        {
            ContractResolver = new Newtonsoft.Json.Serialization.CamelCasePropertyNamesContractResolver(),
            Converters = { new NewtonsoftJsonMicrosoftSpatialGeoJsonConverter() }
        };

        var searchClientOptions = new SearchClientOptions()
        {
            Serializer = new NewtonsoftJsonObjectSerializer(jsonSerializerSettings)
        };

        var searchClient = GetServiceClient(searchClientOptions);


        Response<SearchResults<AdIndex>> response = searchClient.Search<AdIndex>("*", options, CancellationToken.None);

        var batch = IndexDocumentsBatch.Create<AdIndex>();
        var counter = 0;
        await foreach (var record in response.Value.GetResultsAsync())
        {
            Console.WriteLine(record.Document.ForeignId);

            //Create document to upload to the index.

            counter++;

            //if (counter % 4 == 0)
            //    batch.Actions.Add(IndexDocumentsAction.Merge(
            //        new AdIndex()
            //        {
            //            Id = record.Document.Id,
            //            ForeignId = record.Document.ForeignId ?? record.Document.Id,
            //            Location = record.Document.Location ?? Create(43.636105, -79.397964),
            //            SearchLocations = GetRandomLocations(record.Document.Location)
            //        }));

            batch.Actions.Add(IndexDocumentsAction.Merge(
                new AdIndex()
                {
                    Id = record.Document.Id,
                    SearchLocations = new[] { record.Document.Location },
                    Location = record.Document.Location,
                    ForeignId = record.Document.ForeignId
                }));
        }

        try
        {
            // Upload documents to the index.
            await searchClient.IndexDocumentsAsync<AdIndex>(batch);
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
        }
    }


    private GeographyPoint?[] GetRandomLocations(GeographyPoint? defaultLocation)
    {
        var locations = new List<GeographyPoint?>();
        if (defaultLocation != null)
        {
            locations.Add(defaultLocation);
            var random = new Random().Next(0, 2);

            locations.Add(_Randomlocations[random]);

            if (random != 1) return locations.ToArray();
        }

        locations.Add(_Randomlocations[2]);
        locations.Add(_Randomlocations[0]);


        return locations.ToArray();
    }

 
}